# 矩陣 (Matrix)

## **矩陣的定義**

- 矩陣是一種二維陣列，元素以行和列的形式排列。它常用於表示網格、表格以及許多數學運算，如線性變換和圖的表示。

## **矩陣的表示方式**

- 在如 Python 等程式語言中，矩陣可以表示為列表的列表（即陣列的陣列）。每個子列表代表一個行，子列表中的元素對應該行中的列值。

## **基本矩陣運算**

### **加法與減法**

兩個矩陣可以逐元素進行加法或減法，前提是它們具有相同的維度。

---

### **矩陣乘法與點積**

- 如果第一個矩陣的列數與第二個矩陣的行數相等，則可以將兩個矩陣相乘。
- 矩陣乘法與點積是線性代數中兩個重要的運算，它們具有不同的特徵與應用。以下是詳細介紹：

### 1. **矩陣乘法**

矩陣乘法是一種將兩個矩陣結合生成第三個矩陣的方法。最常見的形式是 **標準矩陣乘法**。

#### **標準矩陣乘法（矩陣的點積）**

- **操作**：假設有兩個矩陣 $A$ 和 $B$，其中 $A$ 的大小為 $m \times n$，而 $B$ 的大小為 $n \times p$，則結果將是一個大小為 $m \times p$ 的矩陣 $C$。
- **公式**：結果矩陣中的元素 $C[i][j]$ 是矩陣 $A$ 的第 $i$ 行與矩陣 $B$ 的第 $j$ 列的點積。

$$C[i][j] = \sum_{k=1}^{n} A[i][k] \times B[k][j]$$

- **條件**：標準矩陣乘法要求第一個矩陣 $A$ 的列數等於第二個矩陣 $B$ 的行數。

- **複雜度**：兩個 $n \times n$ 矩陣相乘的時間複雜度是 $O(n^3)$，可以通過更高級的演算法（如 Strassen 演算法）改進為約 $O(n^{2.81})$。

#### **Strassen 矩陣乘法**

- **Strassen 演算法** 通過減少所需的遞迴乘法次數來改進傳統的 $O(n^3)$ 矩陣乘法。
- 它使用更複雜的子矩陣組合來減少乘法次數，而不是直接將矩陣分割為子矩陣進行相乘。
- **時間複雜度**：$O(n^{2.81})$，比傳統方法更快，但並非在所有情況下都是最佳選擇。

#### **逐元素相乘（Hadamard 乘積）**

- **操作**：與標準矩陣乘法不同，逐元素相乘是將兩個矩陣對應位置的元素相乘。

$$C[i][j] = A[i][j] \times B[i][j]$$

- **條件**：兩個矩陣必須具有相同的維度。
- **複雜度**：對於兩個 $n \times n$ 矩陣，時間複雜度為 $O(n^2)$。

### 點積

**兩個矩陣**和**兩個向量**的點積看似相似，但在其定義、結果和應用上有**根本的不同**。以下是比較：

#### 1. **兩個向量的點積**

兩個向量的點積會得到一個**標量值**，它表示一個向量在另一個向量方向上的延展量，通常用於**幾何解釋**，如求**兩個向量**之間的**夾角**。

#### **兩個向量的點積公式**

若 $\mathbf{a}$ 和 $\mathbf{b}$ 是大小為 $n$ 的向量，則點積為：

$$\mathbf{a} \cdot \mathbf{b} = \sum_{i=1}^{n} a_i \times b_i$$

#### **兩個向量點積範例**

對於向量 $\mathbf{a} = [1, 2, 3]$ 和 $\mathbf{b} = [4, 5, 6]$，它們的點積為：

$$\mathbf{a} \cdot \mathbf{b} = (1 \times 4) + (2 \times 5) + (3 \times 6) = 32$$

#### **特徵摘要**

- **結果**：得到一個**標量**（單一數值）。
- **維度**：作用於兩個大小相同的向量。
- **應用**：廣泛用於物理、機器學習（例如計算向量相似度）和幾何中。

---

### 2. **兩個矩陣的點積**

兩個矩陣的點積（通常稱為**矩陣乘法**）會生成一個**新矩陣**，通過將第一個矩陣的行與第二個矩陣的列逐對進行點積來完成運算。

#### **矩陣點積公式**

若 $A$ 是大小為 $m \times n$ 的矩陣， $B$ 是大小為 $n \times p$ 的矩陣，它們的點積結果是大小為 $m \times p$ 的矩陣 $C$，其中每個元素 $C[i][j]$ 的計算方式為：

$$C[i][j] = \sum_{k=1}^{n} A[i][k] \times B[k][j]$$

#### **範例**

對於矩陣 $A$ 和 $B$：

$$A = \begin{bmatrix}
1 & 2 \\
3 & 4
\end{bmatrix}, \quad B =
\begin{bmatrix}
5 & 6 \\
7 & 8
\end{bmatrix}$$

矩陣 $A \cdot B$ 的結果為：

$$C = 
\begin{bmatrix}
(1 \times 5 + 2 \times 7) & (1 \times 6 + 2 \times 8) \\
(3 \times 5 + 4 \times 7) & (3 \times 6 + 4 \times 8)
\end{bmatrix} =
\begin{bmatrix}
19 & 22 \\
43 & 50
\end{bmatrix}$$

#### **主要特徵**

- **結果**：生成一個**新矩陣**（新維度取決於原始矩陣的維度）。
- **維度要求**：第一個矩陣的列數必須等於第二個矩陣的行數。
- **應用**：常用於線性變換、解方程組、圖形處理、機器學習（如神經網絡）等。

---

### **兩個向量和兩個矩陣的點積差異**

| 特徵                              | 兩個向量的點積                                      | 兩個矩陣的點積（矩陣乘法）                        |
|-----------------------------------|----------------------------------------------------|--------------------------------------------------|
| **結果**                          | 標量（單一數值）                                   | 新矩陣                                           |
| **維度要求**                      | 兩個向量必須具有相同大小                           | 第一個矩陣的列數必須等於第二個矩陣的行數           |
| **公式**                          | $\mathbf{a} \cdot \mathbf{b} = \sum a_i \times b_i$ | $C[i][j] = \sum A[i][k] \times B[k][j]$          |
| **計算複雜度**                    | $O(n)$，其中 $n$ 是向量的大小                       | $O(m \times n \times p)$，對於矩陣 $A(m \times n)$ 和 $B(n \times p)$ |
| **結果維度**                      | 標量                                              | 大小為 $m \times p$ 的矩陣                      |
| **應用場合**                      | 幾何解釋、向量相似度、投影                           | 線性變換、神經網絡、圖形處理                      |
| **幾何解釋**                      | 衡量一個向量在另一個向量上的投影                      | 無直接的幾何解釋                                 |

---

### **轉置**

矩陣轉置指的是交換矩陣的行和列。

## **稀疏矩陣**

- 當矩陣中有大量零元素時，這樣的矩陣稱為稀疏矩陣。為了節省記憶體，可以使用特殊的數據結構，如鏈接列表或字典，來高效儲存稀疏矩陣。

### 範例

讓我們以一個 5x5 的矩陣為例，大多數的元素為零：

$$\begin{bmatrix}
0 & 0 & 3 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 \\
4 & 0 & 0 & 0 & 5 \\
0 & 7 & 0 & 0 & 0 \\
0 & 0 & 0 & 9 & 0 \\
\end{bmatrix}$$

#### 稀疏矩陣表示法：

- 在稀疏矩陣中，僅儲存非零元素及其位置以節省記憶體。
- 稀疏矩陣的存儲方式有多種。其中一種最簡單的是 **COO（Coordinate）格式**，它存儲每個非零元素的行索引、列索引和其值。

#### COO 格式下的稀疏矩陣：
| row | column | value |
|:-----:|:-----:|:-----:|
| 0    | 2    | 3    |
| 2    | 0    | 4    |
| 2    | 4    | 5    |
| 3    | 1    | 7    |
| 4    | 3    | 9    |

#### 說明：
- 我們不儲存所有的元素，只儲存非零元素及其相應的行列索引。
- 當處理大型且包含大量零元素的矩陣時，這種方法可以大幅節省記憶體空間。

### Python 程式範例（使用 `scipy` 建立稀疏矩陣）：

```python
import numpy as np
from scipy.sparse import coo_matrix

# 創建一個密集矩陣（5x5 矩陣）
dense_matrix = np.array([
    [0, 0, 3, 0, 0],
    [0, 0, 0, 0, 0],
    [4, 0, 0, 0, 5],
    [0, 7, 0, 0, 0],
    [0, 0, 0, 9, 0]
])

# 將密集矩陣轉換為稀疏矩陣（COO 格式）
sparse_matrix = coo_matrix(dense_matrix)

# 列印稀疏矩陣的數據（行索引、列索引、以及值）
print("Row索引:", sparse_matrix.row)
print("Column索引:", sparse_matrix.col)
print("值:", sparse_matrix.data)
```

### 輸出：
```text
Row索引: [0 2 2 3 4]
Column索引: [2 0 4 1 3]
值: [3 4 5 7 9]
```

此輸出顯示了矩陣中的非零元素、它們的行列索引及其值，正如稀疏矩陣表示的表格所示。

## **在演算法中的應用**

- **圖的表示**：矩陣可用於表示圖，例如鄰接矩陣，其中兩個頂點之間是否存在邊由矩陣中的對應值表示。
- **動態規劃**：例如最短路徑、矩陣鏈乘法等問題在其解決過程中使用了矩陣。
- **矩陣乘法**：Strassen 演算法是一種分治法，通過改進傳統方法來提高矩陣乘法的效率。

## **效能考量**

- 對於大型矩陣的運算可能需要大量計算資源。可以通過區塊法、Strassen 演算法及稀疏矩陣的使用來優化性能。

[[ Python Example ]](02_matrix.ipynb)
